<!doctype html>
<html lang="en">

    <head>
        <title></title>

        <!-- charset setting -->
        <meta charset="utf-8">

        <!-- meta data -->
        <meta name="author" content="Dr Xu Zhang">
        <meta name="generator" content="VS Code">

        <!-- disable search engine robots -->
        <meta name="robots" content="none">

        <!-- viewport settings -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <!-- the default stylsheets -->
        <link rel="stylsheets" href="../../../assets/dist/reset.css">
        <link rel="stylesheet" href="../../../assets/dist/reveal.css">
        <!-- <link rel="stylesheet" href="../../../assets/dist/original.css"> -->
        <link rel="stylesheet" href="../../../assets/dist/theme/black.css" id="theme">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="../../../assets/plugin/highlight/monokai.css">
        <!-- <link rel="stylesheet" href="../../../assets/plugin/highlight/zenburn.css"> -->

        <!-- the chalkboard -->
        <link rel="stylesheet" href="../../../assets/plugin/chalkboard/style.css">
        <!-- custom controls -->
        <link rel="stylesheet" href="../../../assets/plugin/customcontrols/style.css">
        <!-- custom controls font awsome icons -->
        <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins/menu/font-awesome/css/fontawesome.css"> -->
        <!-- rows and columns in one slide -->
        <link rel="stylesheet" href="../../../assets/dist/row_col.css">
        <!-- pointer plugin style -->
        <link rel="stylesheet" href="../../../assets/plugin/pointer/pointer.css" />

        <!-- all links open in new tab -->
        <!-- <base target="_blank"> -->

        <!-- define data here, but update the document later to avoid using
                window.onload = function() {}; syntax -->
        <script>
            const authorData = new Map([
                ['course', 'Classical Artificial Intelligence'],
                ['coursecode', 'COMP712'],
                ['week', '5'],
                ['topic', ' - Monte Carlo Tree Search'],
                ['email', 'Daniel.Zhang@falmouth.ac.uk'],
                ['office', 'Games Academy, Penryn Campus'],
                ['uni', 'Falmouth University'],
                ['officehour', 'Monday 13.00-14.00'],
                ['classroom', 'Room 1002, Games Academy'],
                ['classtime', 'Tuesday & Thursday, 13.00-14.00'],
                ['deadline', 'Monday, 30th Nov 2023'],
                ['name', 'Dr Daniel Zhang'],
                ['nickname', 'Daniel'],
            ]);
        </script>
        <script id="header_pdf_func" src="../../../assets/dist/header.js"></script>
    </head>

    <body>
        <!-- pdf printing by showing a corner strip+
                    put pdf button before anything else, as the z-index makes sure later elements has a 
                    higher z-index than those before. In overview mode, the slides should be in the front.
                -->
        <div class="pdf_div">
            <div class="pdf_link" title="Save Slides as PDF" onclick="GeneratePDF();"><a class="link_no_change" href='#'>â‡©PDF</a></div>
        </div>

        <!-- main content of the slides -->
        <div class="reveal">
            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section id="chap_title">
                    <section id="title">
                        <h1><span class="course"></span></h1>
                        <h3><span class="coursecode orange"></span></h3>
                        <p><span class="week bigtext"></span><span class="topic bigtext"></span></p>
                        <img src="../common/digitap2.png" alt="digital attendance reminder" class="r-stretch" />
                        <p>
                            <span class="fullname cyan"></span> <br>
                            <span class="uni"></span> v. <span class="year"></span>
                        </p>
                    </section>
                </section>

                <section id="chap_game_theory">
                    <section id="game_theory">
                        <h1 class="r-frame-text">Game Theory</h1>
                    </section>

                    <section id="theory">
                        <h1>Game Theory</h1>
                        <ul>
                            <li>A branch of mathematics studying <span class="blue">decision making</span></li>
                            <li>A <span class="cyan">game</span> is a system where one or more <span class="lime">players</span> choose <span class="yellow">actions</span>; the combination of these choices lead to each agent receiving a payoff</li>
                            <li>Important applications in economics, ecology and social sciences as well as AI</li>
                        </ul>
                    </section>

                    <section id="dilemma">
                        <h1>The <span class="strike">Prisoner's</span> Students' Dilemma</h1>
                        <ul>
                            <li>Two students, <span class="red">Alice</span> and <span class="blue">Bob</span>, are suspected of copying from each other</li>
                            <li>Each is offered a deal in exchange for information</li>
                            <li>Each can choose to <span class="pink">betray</span> the other or stay <span class="lime">silent</span> - no <span class="purple">communication</span> before they make the choices</li>
                            <li>If <span class="lime">both stay silent</span>, both receive a C grade</li>
                            <li>If <span class="red">Alice betrays Bob</span>, she gets an A whilst Bob gets expelled</li>
                            <li>If <span class="blue">Bob betrays Alice</span>, he gets an A whilst Alice gets expelled</li>
                            <li>if <span class="pink">both betray each other</span>, both get an F</li>
                        </ul>
                    </section>

                    <section id="payoff">
                        <h1>Payoff Matrix</h1>
                        <table>
                            <tr>
                                <th></th>
                                <th class="with-bg"><span class="bold lime">A Silent</span></th>
                                <th class="with-bg"><span class="bold red">A Betray</span></th>
                            </tr>
                            <tr>
                                <td class="with-bg"><span class="bold lime">B Silent</span></td>
                                <td><span class="orange">A:40<br>B:40</span></td>
                                <td><span class="green">A:70</span><br><span class="red">B:-100</span></td>
                            </tr>
                            <tr>
                                <td class="with-bg"><span class="bold red">B Betray</span></td>
                                <td><span class="red">A:-100</span><br><span class="green">B:70</span></td>
                                <td><span class="purple">A:0<br>B:0</span></td>
                            </tr>
                        </table>
                        <p class="fragment custom blur">Which strategy are you going to choose if you and your best friend were caught?</p>
                        <p class="fragment orange">Is that the best both of you can do?</p>
                    </section>

                    <section id="nash">
                        <h1>Nash Equilibrium</h1>
                        <ul>
                            <li>Consider the situation where both have chosen to betray</li>
                            <li>Neither person has anything to gain by switching to silence, assuming the other person doesn't also switch</li>
                            <li class="fragment">Such as situation is called a <span class="blue">Nash Equilibrium</span></li>
                            <li class="fragment">If all players are <span class="yellow">rational</span> (in the sense of wanting to maximising payoff), they should converge upon a Nash Equilibrium</li>
                        </ul>
                    </section>

                    <section id="rps">
                        <h1>Does every game have a Nash Equilibrium?</h1>
                        <table class="fragment">
                            <tr>
                                <th></th>
                                <th class="with-bg"><span class="red">A Rock</span></th>
                                <th class="with-bg"><span class="orange">A Paper</span></th>
                                <th class="with-bg"><span class="green">A Scissors</span></th>
                            </tr>
                            <tr>
                                <td class="with-bg"><span class="red">B Rock</span></td>
                                <td>A: 0<br>B: 0</td>
                                <td>A: +1<br>B: -1</td>
                                <td>A: -1<br>B: +1</td>
                            </tr>
                            <tr>
                                <td class="with-bg"><span class="orange">B Paper</span></td>
                                <td>A: -1<br>B:+1</td>
                                <td>A: 0<br>B: 0</td>
                                <td>A: +1<br>B: -1</td>
                            </tr>
                            <tr>
                                <td class="with-bg"><span class="green">B Scissors</span></td>
                                <td>A: +1<br>B: -1</td>
                                <td>A: -1<br>B: +1</td>
                                <td>A: 0<br>B: 0</td>
                            </tr>
                        </table>
                        <p class="fragment bigtext bold purple">No!</p>
                    </section>

                    <section id="rps_analysis">
                        <h1>Nash Equilibrium for<br>Rock-Paper-Scissors</h1>
                        <ul>
                            <li class="fragment">Committing to any choice of action can be <span class="blue">exploited</span>
                                <dd>E.g. if you always choose paper, I choose scissors</dd>
                            </li>
                            <li class="fragment">If we try to reason naively, we get stuck in a loop<dd><span class="fragment pink">If I choose paper, you'll choose scissors,</span> <span class="fragment skyblue">so I should choose rock, but then you'll choose paper,</span> <span class="fragment lime">so I'll choose scissors, so you'll choose rock,</span> <span class="fragment">so I choose paper, ...</span></dd>
                            </li>
                            <li class="fragment">The optimum strategy is to be <span class="cyan bold">unpredictable</span></li>
                            <li class="fragment">Choose rock with probability $\frac{1}{3}$, paper with probability $\frac{1}{3}$, and scissors with probability $\frac{1}{3}$</li>
                        </ul>
                    </section>

                    <section id="mixed_strategy">
                        <h1>Mixed Strategies</h1>
                        <ul>
                            <li class="fragment">A <span class="blue">mixed strategy</span> assigns probabilities to actions and chooses one at random</li>
                            <li class="fragment">In contrast to a <span class="orange">pure</span> or <span class="pink">deterministic strategy</span>, which always chooses the same actions</li>
                            <li class="fragment">If we allow mixed strategies, <span class="skyblue">every game has at least one Nash Equilibrium</span></li>
                        </ul>
                    </section>

                    <section id="guess">
                        <h1>Guess $\frac{2}{3}$ of the Average</h1>
                        <ul>
                            <li>Everyone guesses a real number (decimals are allowed) between 0 and 100 inclusive</li>
                            <li>The winner is the person who guesses closest to $\frac{2}{3}$ of the mean of all guesses</li>
                            <li>Example:<br>
                                <ul>
                                    <li>if the guesses are 30, 40,and 80</li>
                                    <li>then the mean is $\frac{30+40+80}{3}=50$</li>
                                    <li>so the winning guess is 30, as this is the closest to <br>$\frac{2}{3} \times 50=33.333...$</li>
                                </ul>
                            </li>
                        </ul>
                    </section>

                    <section id="rationality">
                        <h1>Rationality</h1>
                        <ul>
                            <li>Rationality is a useful assumption for mathematics and AI programmes</li>
                            <li>However, it's important to remember that <br><span class="bigtext2 blue">humans aren't always rational!</span></li>
                        </ul>
                    </section>
                </section>

                <section id="chap_markov">

                    <section id="markov">
                        <h1 class="r-frame-test">Markov Decision Process and Games</h1>
                    </section>

                    <section id="markov_decision_process">
                        <h1>Markov Decision Process</h1>
                        <p class="left">A <span class="cyan">Markov Decision Process (MDP)</span> is defined by:</p>
                        <ul>
                            <li>A finite set <code class="lime">$S$</code> of <span class="orange">states</span></li>
                            <li>A finite set <code class="blue">$A$</code> of <span class="pink">actions</span></li>
                            <li><code class="yellow">$P(s,a,s')$</code> is the <span class="red">probability</span> that action <code class="blue">$a$</code> in state <code class="lime">$s$</code> leads to state <code class="orange">$s'$</code></li>
                            <li><code class="orange">$R(s,a,s')$</code> is the <span class="cyan">reward</span> received from performing action <code class="blue">$a$</code> in state <code class="lime">$s$</code> and ending up in state <code class="orange">$s'$</code></li>
                        </ul>
                    </section>

                    <section id="markov_property">
                        <h1>The Markov Property</h1>
                        <ul>
                            <li>Given state <code class="lime">$s$</code> and action <code class="blue">$a$</code>, the next state <code class="orange">$s'$</code> is determined by <code class="yellow">$P(s,a,s')$</code></li>
                            <li>The previous states before <code class="lime">$s$</code> has no effect</li>
                            <li>Hence and MDP is <span class="italic purple">memoryless</span>
                                <dd>(or rather, any memory has to be contained within the state)</dd>
                            </li>
                        </ul>
                    </section>

                    <section id="non_determinism">
                        <h1>(Non)determinism</h1>
                        <ul>
                            <li>MDP defines <code class="yellow">$P(s,a,s')$</code></li>
                            <li>From state <code class="lime">$s$</code> and action <code class="blue">$a$</code>, there may be several possible states <code class="orange">$s'$</code></li>
                            <li>MDPs are <span class="pink">nondeterministic</span> i.e. <span class="skyblue">stochastic</span></li>
                            <!-- normal space is missing for some reason, has to use \space or other katex supported syntax like \enspace, \quad, \qquad, and \phantom-->
                            <li>If we have
                                <smalltext>\[
                                    P(s,a,s')=\begin{cases}
                                    1, & for\space some\space s' \\
                                    0, & for\space all\space other\space s'
                                    \end{cases}
                                    \]</smalltext>
                                <br>then the MDP is <span class="blue">deterministic</span>
                            </li>
                            <li>In the deterministic case, the same state <code class="lime">$s$</code> and action <code class="blue">$a$</code> always leads to the same state <code class="orange">$s'$</code></li>
                        </ul>
                    </section>

                    <section id="markov_prblem">
                        <h1>Markov Decision problems</h1>
                        <ul>
                            <li>A <span class="skyblue">policy</span> for an MDP is a function <span class="cyan">$\pi: S \to A$</span>
                                <dd>i.e. in state <span class="lime">$s$</span>, choose action <span class="blue">$a$</span>=<span class="cyan">$\pi$</span>(<span class="lime">$s$</span>)</dd>
                            </li>
                            <li>Goal: find <span class="cyan">$\pi$</span> which maximises the total reward over time</li>
                        </ul>
                    </section>

                    <section id="ma_mdp">
                        <h1>Multi-agent MDPs</h1>
                        <ul>
                            <li>We have assumed a <span class="golden">single agent</span> choosing a policy <span class="cyan">$\pi$</span></li>
                            <li>We can extend to <span class="pink">$n$</span> agents choosing policies <span class="cyan">$\pi_1,\pi_2,\cdots,\pi_n$</span></li>
                            <li>The "action" is now a combination <span class="blue">$(a_1,a_2,\cdots,a_n)$</span> of all the agents' actions</li>
                            <li>Each agent has their own reward function and is trying to maximise it</li>
                            <li>This is a <span class="bigtext3 bold orange">game!</span></li>
                        </ul>
                    </section>
                </section>

                <section id="chap_minimax">

                    <section id="minimax_search_title">
                        <h1 class="r-frame-text">Minimax Search</h1>
                    </section>

                    <section id="game_trees">
                        <h1>Game Trees</h1>
                        <img src="img/game_tree.png" alt="game tree" class="r-stretch">
                    </section>

                    <section id="minimax">
                        <h1>Minimax</h1>
                        <ul>
                            <li>Consider a 2-agent MDP with the following restrictions: <ul>
                                    <li>Deterministic</li>
                                    <li>Only one agent chooses an action from a given state</li>
                                    <li>Some states are <span class="red">terminal</span> - these are the only ones with non-zero reward</li>
                                    <li>The game is <span class="skyblue">zero sum</span>: $R_1 (s,a,s')+R_2(s,a,s')=0$</li>
                                </ul>
                            </li>
                            <li>My opponent wants to <span class="lime">maximise</span> his reward, which is the same as <span class="pink">minimise</span> mine</li>
                            <li>Therefore, I want to <span class="lime">minimise</span> the <span class="pink">maximum</span> value my opponent can achieve</li>
                        </ul>
                    </section>

                    <section id="minimax_search">
                        <h1>Minimax Search</h1>
                        <ul>
                            <li>Recursively defines a <span class="blue">value</span> for non-terminal game states (the value function)</li>
                            <li>Consider each possible "next state", i.e. each possible move</li>
                            <li>If it's <span class="cyan">my turn</span>, the value is the <span class="lime">maximum</span> value over next states</li>
                            <li>If it's <span class="purple">my opponent's turn</span>, the value is the <span class="pink">minimum</span> value over next states</li>
                        </ul>
                    </section>

                    <section id="example">
                        <h1>Minimax Example</h1>
                        <img src="img/tic-tac-toe.jpg" alt="tic tac toe" class="r-stretch">
                    </section>

                    <!-- this need to be fixed urgently, otherwise, it's painful to include code in the slide deck -->
                    <section id="pseudo_code">
                        <h1>Minimax Search Pseudo Code</h1>
                        <pre><code class="bigtext vbnet" data-trim data-line-numbers="1-3|4-9|10-15">                           procedure MINIMAX(state, currentPlayer)
                    if state == terminal then
                      return game over
                          else if currentPlayer == 1 then
                    bestValue = -&infin;
                                    for each possible nextState do
                                                    v = MINIMAX(nextState, 3-currentPlayer)
                                          bestValue = MAX(bestValue, v)
                      return bestValue
                          else if currentPlayer == 1 then
                    bestValue = +&infin;
                                    for each possible nextState do
                                                    v = MINIMAX(nextState, 3-currentPlayer)
                                          bestValue = MIN(bestValue, v)
                      return bestValue
                        </code></pre>
                    </section>

                    <section id="improvement">
                        <h1>Stopping Early</h1>
                        <pre><code class="vbnet">                       for each possible nextState do 
                            v = MINMAX(nextState, 3-currentPlayer)
                            bestValue = MAX(bestValue, v)
                        </code></pre>
                        <ul>
                            <li>State values are always between -1 and +1 (designed value function)</li>
                            <li>So if we have <code class="lime">bestValue = 1</code>, we can stop early when <span class="lime">maximising</span></li>
                            <li>Similarly when <span class="pink">minimising</span> if <code class="pink">bestValue = -1</code></li>
                            <li>There are techniques for smarter early stopping, e.g. <span class="orange">alpha-beta pruning</span></li>
                        </ul>
                    </section>

                    <section id="using_minimax">
                        <h1>Using Minimax Search</h1>
                        <ul>
                            <li>To decide which move to play next</li>
                            <li>Calculate the minimax value for each move</li>
                            <li>Choose the move with the maximum score </li>
                            <li>If there are several with the same score, choose one at random</li>
                        </ul>
                    </section>

                    <section id="minimax_and_game_theory">
                        <h1>Minimax and Game Theory</h1>
                        <ul>
                            <li>For a <span class="cyan">two-player</span>, <span class="purple">zero-sum</span> game with <span class="yellow">perfect information</span> and <span class="lime">sequential moves</span></li>
                            <li>Minimax search will always find a <span class="blue">Nash Equilibrium</span>
                                <dd>i.e. a minimax player plays <span class="golden">perfectly</span></dd>
                            </li>
                            <li class="fragment"><span class="red">But...</span></li>
                        </ul>
                    </section>

                    <section id="big_game">
                        <h1>Minimax for Larger Game</h1>
                        <ul>
                            <li>The game tree for noughts and crosses has <span class="blue">only a few thousand</span> states</li>
                            <li>Most games are too large to search fully
                                <ul>
                                    <li><span class="grey">Connect 4</span> has $\approx 10^{13}$ states</li>
                                    <li><span class="gray">Chess</span> has $\approx 10^{47}$ states</li>
                                </ul>
                                <dd>It is just "<span class="golden">impossible</span>" to search the game tree thoroughly!</dd>
                            </li>
                            <li>Generally need to <span class="blue">cut off</span> the tree at a certain depth and use <span class="lime">heuristics</span></li>
                            <li>In practice, define our own reward function that (hopefully) approximates the real one</li>
                        </ul>
                    </section>
                </section>

                <section id="chap_applications">

                    <section id="application_title">
                        <h1 class="r-frame-text">Application to Games</h1>
                    </section>

                    <section id="application_board_game">
                        <h1>Application to Board Games</h1>
                        <ul>
                            <li>The ideas of MDPs and game theory apply readily to board games</li>
                            <li><span class="pink">State</span> = state of the board</li>
                            <li><span class="orange">Action</span> = a move</li>
                            <li><span class="lime">Reward</span> = win/loss, score, etc.</li>
                        </ul>
                    </section>

                    <section id="application_video_game">
                        <h1>Application to Video Games</h1>
                        <ul>
                            <li><span class="italic">Technically</span>, a video game is an MDP
                                <ul>
                                    <li><span class="pink">State</span> = entire state of the game (memory?)</li>
                                    <li><span class="orange">Action</span> = controller input on each frame</li>
                                </ul>
                            </li>
                            <li>However, this is intractable!</li>
                            <li>Generally necessary to <span class="yellow">abstract</span> parts out of the game to treat as MDPs / Game Theory games</li>
                        </ul>
                    </section>

                    <section id="questions">
                        <h2><span class="bold purple">Questions?</span></h2>
                        <img src="../common/questions.PNG" class="r-stretch" alt="question image"><br>
                        <h5>Email: <a class="emaillink"></a></h5>
                        <span class="office cyan"></span>
                    </section>

                    <section id="flowchart" data-visibility="hidden">
                        <h3>Flowchart Example</h3>
                        <div class="mermaid">
                            <pre>
                              %%{init: {'theme': 'dark', 'themeVariables': { 'darkMode': true }}}%%
                              flowchart LR
                                Selector --> A
                                Selector --> B
                                Selector --> Sequence
                                Sequence --> C
                                Sequence --> D
                            </pre>
                        </div>
                    </section>

                </section>
            </div>
        </div>

        <!-- header footer div -->
        <div id="header">
            <!-- <div id="header-left">HEADER-LEFT</div> -->
            <!-- <div id="header-right">HEADER-RIGHT</div> -->
            <div class="footer-left"><a href="http://www.falmouth.ac.uk" target="_blank"><img class="img-width-100 img-round-corner-10 img-zoom-15 fix-bottom-left" src="../common/logo.png" title="visit Falmouth University"></a></div>
            <!-- <div id="footer-right">FOOTER-RIGHT</div> -->
        </div>

        <!-- include all js files and settings -->
        <script id="all_js_files" src="../../../assets/dist/include.js"></script>

    </body>

</html>