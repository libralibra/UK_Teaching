<!doctype html>
<html lang="en">

    <head>
        <title></title>

        <!-- charset setting -->
        <meta charset="utf-8">

        <!-- meta data -->
        <meta name="author" content="Dr Xu Zhang">
        <meta name="generator" content="VS Code + Reveal.js + Markdown + Mermaid">

        <!-- disable search engine robots -->
        <meta name="robots" content="none">

        <!-- viewport settings -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <!-- all css files -->
        <link rel="stylesheet" href="../../../assets/dist/css/master.css">
        <!-- these 2 theme files have to be left here for enabling the them selection in menu -->
        <link rel="stylesheet" href="../../../assets/dist/theme/black.css" id="theme">
        <link rel="stylesheet" href="../../../assets/plugin/highlight/monokai.css" id="theme">

        <!-- define data but update later -->
        <script>
            const authorData = new Map([
                ['course', 'Machine Learning'],
                ['coursecode', 'COMP714'],
                ['week', '3'],
                ['topic', ' - Regression'],
            ]);
        </script>
        <script id="header_pdf_func" src="../../../assets/dist/js/header.js"></script>
    </head>

    <body>
        <div class="pdf_div">
            <div class="pdf_link">
                <a class="link_no_change roll" href="#" onclick="GeneratePDF();">
                    <span data-title="⇩PDF">⇩PDF</span></a><br>
                <span class="yellow" id="time_placeholder" title="Click to show the python console">00:00</span>
            </div>
        </div>

        <!-- main content of the slides -->
        <div class="reveal">
            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section id="chap_1">
                    <section id="title">
                        <h1><span class="course"></span></h1>
                        <h3><span class="coursecode orange"></span></h3>
                        <p><span class="week bigtext"></span><span class="topic bigtext"></span></p>
                        <img src="../common/digitap2.png" alt="digital attendance reminder" class="r-stretch" />
                        <p>
                            <span class="fullname cyan"></span> <br>
                            <span class="uni"></span> v. <span class="year"></span>
                        </p>
                    </section>

                    <section id="overview">
                        <h1>Overview</h1>
                        <ul>
                            <li>Briefly explain supervised learning</li>
                            <li>Focus on classification problem</li>
                            <li>Discuss linear and non-linear regressions</li>
                            <li>Find out how to convert regression problems to classification problems</li>
                        </ul>
                    </section>
                </section>

                <section id="chap_ml">
                    <section id="ml_approaches">
                        <h1>Different ML Approaches</h1>
                        <img src="img/ml_approach.jpg" alt="Machine Learning Approaches: https://www.researchgate.net/publication/347890941/figure/fig1/AS:11431281102724490@1669515651453/A-brief-overview-of-ML-approaches-including-three-major-categories-known-as-supervised_W640.jpg" class="r-stretch">
                        <div class="box-top-left fragment">Supervised<br>Learning</div>
                        <div class="fragment box-top-right">Unsupervised<br>Learning</div>
                        <div class="fragment box-bottom-left">Semi-supervised<br>Learning</div>
                        <div class="fragment box-bottom-right">Reinforcement<br>Learning</div>
                        <div class="box-top-left fragment highlight-bckg-danger">Supervised<br>Learning</div>
                        <div class="box-centre fragment highlight-bckg-info" style="left:25%;top:35%">ML is a fairly broad term<br>
                            break down these techniques into groups<br>
                            easier for us to talk about<br>
                            ML <span class="lightred">$\not =$</span> Neural Networks</div>
                    </section>

                    <section id="supervised_learning">
                        <h1>Supervised Learning</h1>
                        <ul>
                            <li>For supervised learning tasks, we have data that already has the '<span class="lime">thing</span>' we want to know (sometimes called <span class="lightblue">outputs</span> or <span class="skyblue">labels</span>) and a set of related parameters </li>
                            <dd class="fragment">
                                <span class="like-li-2">House price: year of sale, number of bedrooms, total area, ...</span><br>
                                <span class="like-li-2">Car or Dog: pointy ears, colour, length of tail, breed, ...</span><br>
                                <span class="like-li-2">Game score: number of players, current game state, number of lives, ...</span>
                            </dd>
                            <li class="fragment"><span class="blue">What's the point in asking the question if we already know the answer?</span>
                            </li>
                            <dd class="fragment like-li-2">use the data to <span class="lime">train</span> a model to <span class="orange">make predictions</span> when we <span class="purple">don't</span> know the answer</dd>
                        </ul>
                    </section>

                    <section id="supervised_learning_2">
                        <h1>Supervised Learning (2)</h1>
                        <ul>
                            <li>We have a set of labelled data (from somewhere)</li>
                            <li><span class="blue">Labels</span> = the thing we want to know</li>
                            <li><span class="orange">‘Correctness’</span> is how well it maps input data to labels</li>
                            <li>Two major ‘types’ of label: <span class="red">categorical</span> and <span class="lime">continuous</span></li>
                        </ul>
                    </section>
                </section>

                <section id="chap_regression">
                    <section id="title_regression">
                        <h1 class="r-frame-text">Regression</h1>
                    </section>

                    <section id="regression_example" data-auto-animate>
                        <h1 data-id="dh">Regression Example (Recall)</h1>
                        <img data-id="dm" class="box-top-right img-width-750 img-height-400" src="img/regression_anime.gif" alt="Regression Process: https://miro.medium.com/v2/resize:fit:828/format:webp/1*0Ve21Rildq950wRrlJvdLQ.gif">
                        <div data-id="dv" class="box-left col-40 text-left">
                            <span class="like-li">Regression is for when the data is <span class="lime italic">continuous</span></span><br>
                            <span class="like-li">We're essentially finding a '<span class="red italic">line of best fit</span>' in multiple dimensions</span><br>
                            <span class="like-li">e.g. stock price, driving speed, estimated score when game over, ...</span><br>
                            <span class="like-li"><span class="cyan">Linear</span> Regression or <span class="brown">Nonlinear</span> Regression</span>
                        </div>
                    </section>

                    <section id="linear_nonlinear">
                        <h1>Linear vs. Non-Linear Regression</h1>
                        <img src="img/linear_nonlinear.png" alt="Linear vs. Non-Linear Regression: https://deepstash.com/_next/image?url=https:%2F%2Fd1dfxfqogsjixt.cloudfront.net%2F231700-1651922343.png&w=828&q=75" class="r-stretch">
                        <p class="like-li text-left">Can be roughly seen from <span class="lime">Scatter Plot</span> of the raw data</p>
                        <p class="like-li text-left">Data points have a pattern that looks like a <span class="brown">Straight Line</span> indicates a linear regression problem</p>
                    </section>
                </section>

                <section id="chap_linear">

                    <section id="title_linear">
                        <h1 class="r-frame-text">Linear Regression</h1>
                    </section>

                    <section id="linear_regression">
                        <h1>Linear Regression</h1>
                        <ul>
                            <li>Input: $X$, output: $Y$</li>
                            <li><span class="lime">Linear</span> correlation between $X$ and $Y$ (with some noises) $\qquad\qquad\qquad\quad\;\;$</li>
                            <dd class="like-li-2">Hours of studying vs. final marks</dd>
                            <dd class="like-li-2">Bottles of beers at night vs. coding skill</dd>
                        </ul>
                        <img src="img/lineaer.png" alt="Linear Regression: https://th.bing.com/th/id/OIP.GE8pmX9MGqxWu5m5bowRyAAAAA?rs=1&pid=ImgDetMain" class="box-top-right">
                    </section>

                    <section id="linear_regression_2">
                        <h1>Linear Regression (2)</h1>
                        <p class="lightred">$\hat{y}=\theta_0 +\theta_1 x_1+\theta_2 x_2+\cdots+\theta_n x_n$</p>
                        <ul>
                            <dd class="like-li-3">$\^{y}$ is the predicted value</dd>
                            <dd class="like-li-3">$n$ is the number of features</dd>
                            <dd class="like-li-3">$x_i$ is the $i^{th}$ feature value</dd>
                            <dd class="like-li-3">$\theta_j$ is the $j^{th}$ model parameter (including the bias term $\theta_0$ and the feature weights $\theta_1, \theta_2, \cdots, \theta_n$</dd>
                        </ul>
                    </section>

                    <section id="linear_regression_3">
                        <h1>Linear Regression (3)</h1>
                        <p class="text-left">More concisely:
                            $$\^{y} = h_{\theta}(x) = \theta^T \cdot x$$
                        </p>
                        <dd class="like-li-3 text-left">$\theta$ is the model's <span class="lime">parameter vector</span>, containing the <span class="pink">bias term</span> $\theta_0$ and the <span class="brown">feature weights</span> $\theta_1$ to $\theta_n$</dd>
                        <dd class="like-li-3 text-left">$\theta^T$ is the <span class="skyblue">transpose</span> of $\theta$ (a row vector instead of a column vector)</dd>
                        <dd class="like-li-3 text-left">$x$ is the instance's <span class="blue">feature vector</span>, containing $x_0$ to $x_n$ with $x_0 \equiv 1$</dd>
                        <dd class="like-li-3 text-left">$\theta^T\cdot x$ is the <span class="orange">dot product</span> of $\theta^T$ and $x$</dd>
                        <dd class="like-li-3 text-left">$h_{\theta}$ is the <span class="lightred">hypothesis function</span>, using the model parameters $\theta$</dd>
                    </section>

                    <section id="linear_regression_4">
                        <h1>Linear Regression (4)</h1>
                        <p class="blue">Which hypothesis model/model parameters would be the best?</p>
                        <span class="smalltext">$$J(\theta) = MSE(X, h_{\theta}) = \frac{1}{m}\sum_{i=1}^{m} (h_{\theta}(x^{(i)}) - y^{(i)})^2$$</span>
                        <dd class="like-li-3 text-left">$m$: number of data points</dd>
                        <dd class="like-li-3 text-left">$h_{\theta}(x^{(i)})$: predicted value using $x^{(i)} \in X$</dd>
                        <dd class="like-li-3 text-left">$y$: true value (target value)</dd>
                        <p class="fragment like-li text-left">Objective: <span class="lime">minimise</span> loss function $J(\theta)$ (e.g. MSE)</p>
                        <span class="fragment">
                            <p class="like-li text-left">Analytical solution for $\^{\theta}$ minimises $J(\theta)$:</p>
                            <dd class="like-li-2 text-left">use <span class="pink">Normal Equation</span> <span class="smalltext">$\^{\theta} = (X^T\cdot X)^{-1}\cdot X^T\cdot y$</span></dd>
                        </span>
                    </section>
                </section>

                <section id="chap_non_linear">
                    <section id="title_non_linear">
                        <h1 class="r-frame-text">Polynomial Regression</h1>
                    </section>

                    <section id="polynomial_regression">
                        <h1>Polynomial Regression</h1>
                        Solve the problems that are more complex than linear, e.g. Ballmer's peak<br>
                        <img src="img/ballmer_peak.png" alt="Ballmer's Peak: https://imgs.xkcd.com/comics/ballmer_peak.png" class="img-height-550">
                    </section>

                    <section id="polynomial_regression_2" data-auto-animate>
                        <h1 data-id="dh">Polynomial Regression (2)</h1>
                        More seriously ... <br>
                        <img data-id="dm" src="img/poly_fit.png" alt="Polynomial Regression" class="r-stretch"><br>
                        Increase the <span class="pink">degrees/order</span> of the polynomial equation
                    </section>

                    <section id="polynomial_regression_3" data-auto-animate>
                        <h1 data-id="dh">Polynomial Regression (3)</h1>
                        How to choose the <span class="cyan">best degree</span> for polynomial model? <br>
                        <img data-id="dm" src="img/poly_fit_2.png" alt="Polynomial Regression Problems" class="r-stretch"><br>
                        What happened in the case of $d=300$? How about $d=1$?<br>
                        <span class="fragment"><span class="lime">overfitting</span> if $d=300$ and <span class="red">underfitting</span> if $d=1$</span>
                    </section>

                    <section id="underfitting_check" data-auto-animate>
                        <h1 data-id="dh">Polynomial Regression (4)</h1>
                        How can we tell if the model suffers from <span class="lightred">underfitting</span>? <br>
                        <img data-id="dm" src="img/underfitting.png" alt="Polynomial Regression Underfitting" class="r-stretch"><br>
                        <span class="fragment">
                            <span class="blue">Hint:</span> loss on both training and validation sets converges to a large value<br>
                            <span class="orange">Fix: </span> increase model complexity
                        </span>
                    </section>

                    <section id="overfitting_check" data-auto-animate>
                        <h1 data-id="dh">Polynomial Regression (5)</h1>
                        How can we tell if the model suffers from <span class="purple">overfitting</span>? <br>
                        <img data-id="dm" src="img/overfitting.png" alt="Polynomial Regression Overfitting" class="r-stretch"><br>
                        <span class="fragment">
                            <span class="blue">Hint:</span> there is a big gap in losses for training and validation sets<br>
                            <span class="orange">Fix: </span> increase training data size, reduce training time
                        </span>
                    </section>
                </section>

                <section id="chap_generalisation">
                    <section id="title_generalisation" data-auto-animate>
                        <h1 data-id="dh">Regularisation</h1>
                        <ul data-id="du">
                            <li>Occam's razor (Ockham, $14^{th}$ century)
                                <blockquote class="skyblue">Entities should not be multiplied unnecessarily</blockquote>
                            </li>
                            <li class="fragment">Make it more clear:
                                <blockquote class="pink">when you have two competing theories that make exactly the same predictions, the simpler one is the better</blockquote>
                            </li>
                            <li class="fragment"><span class="lime">Idea</span>: capture model complexity in the cost function
                                <dd class="like-li-2">i.e. cost function = loss + model complexity</dd>
                            </li>
                        </ul>
                    </section>

                    <section id="generalisation" data-auto-animate>
                        <h1 data-id="dh">Regularisation (2)</h1>
                        <ul data-id="du">
                            <li><span class="lime">Idea</span>: capture model complexity in the cost function
                                <dd class="like-li-2">i.e. cost function = loss + model complexity</dd>
                            </li>
                            <li><span class="blue">Ridge</span> regression (Tikhonov regularisation): linear regression + regularisation</li>
                            <dd class="like-li-2">$J(\theta)=MSE(\theta)+\alpha \frac{1}{2} \sum_{i=1}^n \theta_i^2$</dd>
                            <li><span class="orange">LASSO</span> (Least Absolute Shrinkage and Selection Operator Regression)</li>
                            <dd class="like-li-2">$J(\theta)=MSE(\theta)+\alpha \sum_{i=1}^n \vert \theta_i \vert$</dd>
                            <li><span class="pink">Elastic Net</span>:</li>
                            <dd class="like-li-2">$J(\theta)=MSE(\theta)+r \alpha \sum_{i=1}^n \vert \theta_i \vert + \frac{1-r}{2} \alpha \sum_{i=1}^n \theta_i^2$</dd>
                        </ul>
                    </section>

                    <section id="solve_regularised_model" data-auto-animate>
                        <h1 data-id="dh2">Solve Regularised Model</h1>
                        <p class="like-li text-left">Closed form solution for ridge regression:
                            $$ \^{\theta} = (X^T \cdot X + \alpha A)^{-1}\cdot X^T \cdot y $$
                        </p>
                        <p class="like-li text-left">LASSO + Elastic Net: gradient descent approach</p>
                        <img data-id="dm2" src="img/gradient_descent.png" alt="Gradient Descent: https://media.geeksforgeeks.org/wp-content/uploads/20230424151248/Gradient-Descent-for-ML-Linear-Regression-(1).webp" class="r-stretch">
                    </section>

                    <section id="gradient_descent" data-auto-animate>
                        <h1 data-id="dh2">Gradient Descent</h1>
                        <img data-id="dm2" src="img/gradient_descent.png" alt="Gradient Descent: https://media.geeksforgeeks.org/wp-content/uploads/20230424151248/Gradient-Descent-for-ML-Linear-Regression-(1).webp" class="r-stretch"><br>
                        <span class="smalltext">$\theta^{next \> step} = \theta - \gamma \nabla_{\theta} MSE(\theta) $</span><br>
                        <p class="like-li text-left"><span class="lime">Main issue</span>: need whole training set to calculate the error and the gradients</p>
                        <dd class="like-li-2 text-left"><span class="blue">Stochastic gradient descent (SGD)</span>: randomly choose one data point and calculate the error function and its gradient for the single data point</dd>
                    </section>

                    <section id="regression_as_classifier">
                        <h1>Regression as Classifier</h1>
                        <ul>
                            <li><span class="lime">Logistic regression</span>: computes the probability that $\qquad\qquad\qquad\qquad\qquad$<br>
                                the data belongs to a certain type
                                <dd class="like-li-2 smalltext">$\qquad\qquad \^{p} = h_{\theta}(x) = \sigma (\theta^T \cdot x)$</dd>
                            </li>
                            <li>Linear regression $\implies$ logistic regression (<span class="lightgreen">sigma</span>)</li>
                            <dd class="like-li-2">the logistic (logit) is a <span class="cyan">sigmoid</span> function</dd>
                            <dd class="like-li-2 smalltext">$\qquad\qquad
                                \^{y} =
                                \begin{cases}
                                0 & if \> \^{p} \lt 0.5 \\
                                1 & if \> \^{p} \ge 0.5
                                \end{cases} $</dd>
                            <img class="box-bottom-right img-width-400" src="img/sigmoid.png" alt="Sigmoid Function: https://miro.medium.com/v2/resize:fit:650/1*Eo-AiyPjNO7lSL1PzgVQ-Q.png">
                        </ul>
                    </section>

                    <section id="regression_as_classifier_2">
                        <h1>Regression as Classifier (2)</h1>
                        <ul>
                            <li>Train the <span class="pink">logistic regression</span> model:
                                $$J(\theta)= - \frac{1}{m} \sum_{i=1}^m [y^{(i)}log(\^{p}^{(i)}) + (1-y^{(i)})log(1-\^{p}{(i)})]$$
                            </li>
                            <li>This is the log loss:</li>
                            <dd class="like-li-2">No closed form solution</dd>
                            <dd class="like-li-2"><span class="lightblue">SGD</span> can find a local minimum efficiently</dd>
                        </ul>
                    </section>

                    <section id="regression_as_classifier_3">
                        <h1>Regression as Classifier (3)</h1>
                        <ul>
                            <li><span class="purple">Softmax</span> regression: <span class="lime">multi-class</span> classification</li>
                            <dd class="like-li-2">Idea: maintain a score for each class</dd>
                            <dd class="like-li-2">Use these scores to calculate the probability of likelihood</dd>
                            <li>Softmax score: $s_k (x) = \theta_k^T \cdot x$</li>
                            <li>Softmax function:</li>
                            <dd class="like-li-2">$\^{p} = \sigma(s(x))_k = \frac{exp(s_k(x))}{\sum_{j=1}^K exp(s_j (x))}$</dd>
                            <dd class="like-li-3">$K$ is the <span class="blue">number</span> of classes</dd>
                            <dd class="like-li-3">$s(x)$ is a vector containing the <span class="orange">scores</span> of each class for the instance $x$</dd>
                            <dd class="like-li-3">$\sigma(s(x))_k$ is the estimated <span class="red">probability</span> that the instance $x$ belongs to class $k$</dd>
                        </ul>
                    </section>
                </section>

                <section id="chap_summary">
                    <section id="summary">
                        <h1>Summary</h1>
                        <ul>
                            <li>Review supervised learning</li>
                            <li>Explain regression problem</li>
                            <li>When regression becomes classification (next session)</li>
                        </ul>
                    </section>

                    <section id="questions">
                        <h2><span class="bold purple">Questions?</span></h2>
                        <img src="../common/questions.PNG" class="r-stretch" alt="question image"><br>
                        <h5>Email: <a class="emaillink"></a></h5>
                        <span class="office cyan"></span>
                        </h6>
                    </section>
                </section>
            </div>
        </div>

        <!-- header footer div -->
        <div id="header">
            <!-- <div id="header-left">HEADER-LEFT</div> -->
            <!-- <div id="header-right">HEADER-RIGHT</div> -->
            <div class="footer-left"><a href="http://www.falmouth.ac.uk" target="_blank"><img class="img-width-100 img-round-corner-10 img-zoom-15 fix-bottom-left" src="../common/logo.png" title="visit Falmouth University"></a></div>
            <!-- <div id="footer-right">FOOTER-RIGHT</div> -->
        </div>

        <!-- include all js files and settings -->
        <script id="all_js_files" src="../../../assets/dist/js/include.js"></script>

    </body>

</html>